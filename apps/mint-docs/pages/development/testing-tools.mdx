---
title: "Development Tools"
description: "Testing and development utilities for InBrowser file conversion"
---

# Development Tools

InBrowser includes comprehensive testing and development utilities to ensure reliable file conversion functionality.

## Testing Suite

### Automated Conversion Testing

The project includes automated tests that verify all supported file format conversions.

#### Run All Tests
```bash filename="run-all-tests"
bun run test_all_conversions.ts
```

This script:
- **Bootstraps** missing file types by generating them from existing files
- **Tests** all 65 possible conversion pairs
- **Reports** success/failure status with detailed error messages
- **Generates** output files for manual verification

#### Test Specific Conversions
```bash filename="run-failing-tests"
bun run test_failing_conversions.ts
```

Focuses on previously problematic conversions to verify fixes.

### Test Results

<Callout type="success">
**Current Status**: 62/65 conversions working (95% success rate)
</Callout>

| Category | Total | Working | Success Rate |
| :-------- | :---- | :------ | :----------- |
| Video Conversions | 48 | 48 | 100% |
| Audio Conversions | 35 | 35 | 100% |
| Image Conversions | 40 | 38 | 95% |
| Document Conversions | 15 | 13 | 87% |

## File Generation Utilities

### Missing File Generator

Creates missing source files for comprehensive testing.

```bash filename="generate-files"
bun run generate_missing_files.ts
```

**Generated Files**:
- **Video**: `.mov`, `.mkv`, `.flv`, `.wmv`, `.m4v`
- **Audio**: `.m4a`, `.wma`
- **Images**: `.jpeg`, `.bmp`, `.tiff`
- **Documents**: `.md`

**Process**:
1. Scans existing files in `files/` and `generated_test_files/`
2. Identifies missing formats from the supported matrix
3. Uses FFmpeg to convert existing files to missing formats
4. Saves generated files in `generated_test_files/` directory

### File Structure

```
apps/server/
├── files/                    # Original source files
├── generated_test_files/     # Auto-generated test files
├── test_outputs/            # Test conversion results
├── test_all_conversions.ts  # Complete test suite
├── test_failing_conversions.ts # Focused test for fixes
└── generate_missing_files.ts # File generation utility
```

## Development Workflow

### 1. Setup Test Environment
```bash
# Generate missing source files
bun run generate_missing_files.ts

# Ensure server is running
bun run api/index.ts
```

### 2. Run Tests
```bash
# Run complete test suite
bun run test_all_conversions.ts

# Or run focused tests
bun run test_failing_conversions.ts
```

### 3. Verify Results
```bash
# Check test outputs
ls -la test_outputs/

# Review server logs
tail -f server.log
```

## Debugging Tools

### Server Logs
Monitor conversion requests and errors in real-time:

```bash
# Start server with logging
bun run api/index.ts > server.log 2>&1 &

# Follow logs
tail -f server.log
```

### Manual Testing
Test specific conversions manually:

```bash filename="manual-test"
# Test GIF to PNG
curl -X POST http://localhost:3000/api/convert \
  -F "file=@generated_test_files/sample.gif" \
  -F "format=png" \
  -o output.png

# Test PDF to JPG
curl -X POST http://localhost:3000/api/convert \
  -F "file=@files/file-sample_150kB.pdf" \
  -F "format=jpg" \
  -o output.jpg
```

## Performance Monitoring

### Conversion Metrics
The test suite tracks:
- **Success Rate**: Percentage of successful conversions
- **Processing Time**: Time taken for each conversion
- **Error Types**: Categorization of failure reasons
- **File Sizes**: Input/output file size relationships

### Optimization Features
- **Timeout Handling**: 60-second default with format-specific adjustments
- **Memory Management**: Efficient buffer handling and cleanup
- **FFmpeg Presets**: Optimized encoding settings for different formats
- **Parallel Processing**: Concurrent test execution where possible

## Troubleshooting

### Common Issues

#### FFmpeg Errors
```bash
# Check FFmpeg installation
ffmpeg -version

# Verify FFmpeg static path
ls -la node_modules/ffmpeg-static/
```

#### Canvas Rendering Issues
```bash
# Check canvas installation
npm list @napi-rs/canvas

# Verify canvas support
node -e "require('@napi-rs/canvas')"
```

#### PDF Processing Issues
```bash
# Check PDF libraries
npm list pdfjs-dist
npm list pdf-parse
```

### Test Failures

When tests fail, check:
1. **Server Logs**: Look for specific error messages in `server.log`
2. **File Permissions**: Ensure read/write access to test directories
3. **Memory**: Monitor system memory during large file conversions
4. **Dependencies**: Verify all required libraries are installed

<Callout type="warning">
**Known Issues**: PDF to image conversions currently experiencing worker configuration issues with pdfjs-dist library.
</Callout>

## Contributing

When adding new conversion support:

1. **Update Test Matrix**: Add new formats to `SUPPORTED_FORMATS` in test files
2. **Generate Test Files**: Use `generate_missing_files.ts` for new source formats
3. **Update Documentation**: Modify supported formats documentation
4. **Run Tests**: Verify all existing conversions still work
5. **Add Edge Cases**: Test with various file sizes and content types

### Test Development

Create focused tests for new features:

```typescript filename="example-test"
// Example: Test new format support
const testNewConversion = async () => {
  const result = await convert('source.xyz', 'target.format');
  console.log(`New conversion: ${result.success ? '✅' : '❌'}`);
};
```

This comprehensive testing infrastructure ensures reliable file conversion functionality and makes it easy to validate changes and additions to the conversion system.